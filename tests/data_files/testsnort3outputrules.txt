alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"Tuning JSON API DNS over HTTPS detected"; flow:established,to_server; http_header; content:"application/dns-json"; reference:url,tools.ietf.org/html/draft-ietf-doh-dns-over-https-02; classtype:policy-violation; sid:1000000; rev:1; metadata:created_at 2021_01_25, updated_at 2021_01_25;)
alert http any any -> $EXTERNAL_NET any (msg:"Tuning SolarWinds Orion User-Agent"; flow:to_server,established; http_header: field user-agent; content:"SolarWindsOrionImprovementClient/", nocase; reference:url,foobar.baz.com; classtype:misc-activity; sid:1000001; rev:1; metadata:affected_product SolarWinds, created_at 2021_01_11, signature_severity Major, tag User_Agent, updated_at 2021_01_11;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 443 (msg:"Tuning SSL 2.0 using preprocessor version and state client_hello"; ssl_version:sslv2; ssl_state:client_hello; reference:url,foobar.com; sid:1000002; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 443 (msg:"Tuning SSL 2.0 using hex version and state client_hello"; content:"|16 00 02|", depth 3; content:"|01|", distance 2, within 1; reference:url,foobar.com; sid:1000003; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 443 (msg:"Tuning SSL 3.0 using preprocessor version and state client_hello"; ssl_version:sslv3; ssl_state:client_hello; reference:url,foobar.com; sid:1000004; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 443 (msg:"Tuning SSL 3.0 using hex version and state client_hello"; content:"|16 03 00|", depth 3; content:"|01|", distance 2, within 1; reference:url,foobar.com; sid:1000005; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 443 (msg:"Tuning TLS 1.0 using preprocessor version and state client_hello"; ssl_version:tls1.0; ssl_state:client_hello; reference:url,foobar.com; sid:1000006; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 443 (msg:"Tuning TLS 1.0 using hex version and state client_hello"; content:"|16 03 01|", depth 3; content:"|01|", distance 2, within 1; reference:url,foobar.com; sid:1000007; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 443 (msg:"Tuning TLS 1.1 using preprocessor version and state client_hello"; ssl_version:tls1.1; ssl_state:client_hello; reference:url,foobar.com; sid:1000008; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 443 (msg:"Tuning TLS 1.1 using hex version and state client_hello"; content:"|16 03 02|", depth 3; content:"|01|", distance 2, within 1; reference:url,foobar.com; sid:1000009; rev:1;)
alert tcp $HOME_NET 443 -> $EXTERNAL_NET any (msg:"Tuning SSL 2.0 using preprocessor version and state server_hello"; ssl_version:sslv2; ssl_state: server_hello; reference:url,foobar.com; sid:1000010; rev:1;)
alert tcp $HOME_NET 443 -> $EXTERNAL_NET any (msg:"Tuning SSL 2.0 using hex version and state server_hello"; content:"|16 00 02|", depth 3; content:"|02|", distance 2, within 1; reference:url,foobar.com; sid:1000011; rev:1;)
alert tcp $HOME_NET 443 -> $EXTERNAL_NET any (msg:"Tuning SSL 3.0 using preprocessor version and state server_hello"; ssl_version:sslv3; ssl_state: server_hello; reference:url,foobar.com; sid:1000012; rev:1;)
alert tcp $HOME_NET 443 -> $EXTERNAL_NET any (msg:"Tuning SSL 3.0 using hex version and state server_hello"; content:"|16 03 00|", depth 3; content:"|02|", distance 2, within 1; reference:url,foobar.com; sid:1000013; rev:1;)
alert tcp $HOME_NET 443 -> $EXTERNAL_NET any (msg:"Tuning TLS 1.0 using preprocessor version and state server_hello"; ssl_version:tls1.0; ssl_state: server_hello; reference:url,foobar.com; sid:1000014; rev:1;)
alert tcp $HOME_NET 443 -> $EXTERNAL_NET any (msg:"Tuning TLS 1.0 using hex version and state server_hello"; content:"|16 03 01|", depth 3; content:"|02|", distance 2, within 1; reference:url,foobar.com; sid:1000015; rev:1;)
alert tcp $HOME_NET 443 -> $EXTERNAL_NET any (msg:"Tuning TLS 1.1 using preprocessor version and state server_hello"; ssl_version:tls1.1; ssl_state: server_hello; reference:url,foobar.com; sid:1000016; rev:1;)
alert tcp $HOME_NET 443 -> $EXTERNAL_NET any (msg:"Tuning TLS 1.1 using hex version and state server_hello"; content:"|16 03 02|", depth 3; content:"|02|", distance 2, within 1; reference:url,foobar.com; sid:1000017; rev:1;)
